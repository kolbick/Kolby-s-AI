<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Treatment Plan</title>
  <link rel="stylesheet" href="assets/style.css?v=kolby-v1" />
</head>

<body>
  <div class="page-container">
    <h1>Treatment Plan</h1>
    <p>This plan updates automatically when you add new notes.</p>

    <div id="planBody"></div>

    <a href="note.html" class="btn btn-primary">Add Another Note</a>
    <button id="resetBtn" class="btn btn-ghost">Reset Records</button>
  </div>

<script>
const record = JSON.parse(localStorage.getItem("patientRecord") || "{}");

function renderPlan() {
  if (!record.problems || record.problems.length === 0) {
    document.getElementById("planBody").innerHTML = "<p>No data yet.</p>";
    return;
  }

  let html = "";

  record.problems.forEach((p, i) => {
    html += `
      <div class="plan-block">
        <h3>Problem ${i + 1}</h3>
        <p><strong>Problem:</strong> ${p.problem || ""}</p>
        <p><strong>As evidenced by:</strong> ${p.as_evidenced_by || ""}</p>
        <p><strong>Long Term Goal:</strong> ${p.long_term_goal || ""}</p>

        <strong>Short-Term Objectives:</strong>
        <ul>${(p.short_term_objectives || []).map(o => `<li>${o}</li>`).join("")}</ul>

        <strong>Interventions:</strong>
        <ul>${(p.interventions || []).map(i => `<li>${i}</li>`).join("")}</ul>
      </div>
    `;
  });

  document.getElementById("planBody").innerHTML = html;
}

renderPlan();

document.getElementById("resetBtn").onclick = () => {
  localStorage.clear();
  location.reload();
};
</script>
</body>
</html>
